tosca_definitions_version: tosca_2_0

imports:

- data.yaml

capability_types:

  Runnable:
    description: >-
      Base type for continuously-running Service and short-running Task.
    properties:
      temporality:
        type: string
        constraints:
        - valid_values: [ Continuous, ASAP, Specific, Delayed, Recurring ]
        default: Continuous
      specific-temporality:
        type: timestamp
        required: false
      delayed-temporality:
        type: scalar-unit.time
        required: false
      recurring-temporality:
        type: Schedule
        required: false
      user:
        description: >-
          Operating system user owning the runnable. If not provided will be the user owning the host service.
        type: string
        required: false
      systemd:
        type: boolean
        default: true
    attributes:
      delegate:
        type: string
      host:
        type: string

  Connectable:
    description: >-
      By default has no opinion on the semantics of incoming connections. For example, all connections could
      share the same port and be sesssionless. Or, it could be the same port but require an authenticated
      session. Or, an entirely new port could be opened for each connection, ensuring that each is isolated.
    properties:
      standby:
        description: >-
          When true will set up connectability even if there are no incoming connections.
        type: boolean
        default: false

  Storage: {}

  # Runnables

  Process:
    derived_from: Runnable
    properties:
      command:
        type: Command
    attributes:
      delegate:
        default: bare

  Container:
    derived_from: Runnable
    properties:
      name:
        description: >-
          If not provided will use the node's name.
        type: string
        required: false
      image:
        description: >-
          OCI pseudo-URI. If not provided a ContainerImage artifact would have to be attached instead.
        type: ContainerImageReference
        required: false
      create-arguments:
        type: list
        entry_schema: string
        required: false
    attributes:
      delegate:
        default: podman

  Pod:
    derived_from: Runnable
    properties:
      images:
        description: >-
          OCI pseudo-URIs. If not provided ContainerImage artifacts would have to be attached instead.
        type: list
        entry_schema: ContainerImageReference
        required: false
    attributes:
      delegate:
        default: podman

  VirtualMachine:
    derived_from: Runnable

  # Connectable

  ContainerConnectable:
    derived_from: Connectable
    attributes:
      ports:
        type: list
        entry_schema: ContainerPort

  # Storage

  LocalDirectory:
    derived_from: Storage
    properties:
      path:
        type: string
        required: false
      temporary:
        type: boolean
        default: false
